/**
 * tua-body-scroll-lock v1.5.1-beta.1
 * (c) 2024 Evinma, BuptStEve
 * @license MIT
 */
const e=()=>"undefined"==typeof window,t=e=>{e=e||navigator.userAgent;const t=/(iPad).*OS\s([\d_]+)/.test(e);return{ios:!t&&/(iPhone\sOS)\s([\d_]+)/.test(e)||t,android:/(Android);?[\s/]+([\d.]+)?/.test(e)}};function n(t){if(e())return!1;if(!t)throw new Error("options must be provided");let n=!1;const o={get passive(){n=!0}},i=()=>{},l="__TUA_BSL_TEST_PASSIVE__";window.addEventListener(l,i,o),window.removeEventListener(l,i,o);const{capture:c}=t;return n?t:void 0!==c&&c}function o(){return"__BSL_PREVENT_DEFAULT__"in window||(window.__BSL_PREVENT_DEFAULT__=function(e){e.cancelable&&e.preventDefault()}),window.__BSL_PREVENT_DEFAULT__}function i(e){return e?Array.isArray(e)?e:[e]:[]}const l={lockedNum:0,lockedElements:[],unLockCallback:null,documentListenerAdded:!1,initialClientPos:{clientX:0,clientY:0}};function c(t){if(e())return l;if(!(null==t?void 0:t.useGlobalLockState))return c.lockState;const n="__BSL_LOCK_STATE__"in window?Object.assign(Object.assign({},l),window.__BSL_LOCK_STATE__):l;return window.__BSL_LOCK_STATE__=n,n}function s(l,s){if(e())return;const d=t(),r=c(s);d.ios?(i(l).filter((e=>-1===r.lockedElements.indexOf(e))).forEach((e=>{e.ontouchstart=e=>{const{clientX:t,clientY:n}=e.targetTouches[0];r.initialClientPos={clientX:t,clientY:n}},e.ontouchmove=t=>{!function(e,t,n){if(t){const{scrollTop:i,scrollLeft:l,scrollWidth:c,scrollHeight:s,clientWidth:d,clientHeight:r}=t,u=e.targetTouches[0].clientX-n.clientX,a=e.targetTouches[0].clientY-n.clientY,f=Math.abs(a)>Math.abs(u);if(f&&(a>0&&0===i||a<0&&i+r+1>=s)||!f&&(u>0&&0===l||u<0&&l+d+1>=c))return o()(e)}e.stopPropagation()}(t,e,r.initialClientPos)},r.lockedElements.push(e)})),function(e){if(!t().ios)return;if(e.documentListenerAdded)return;document.addEventListener("touchmove",o(),n({passive:!1})),e.documentListenerAdded=!0}(r)):r.lockedNum<=0&&(r.unLockCallback=d.android?function(e){const t=document.documentElement,n=document.body,o=t.scrollTop||n.scrollTop,i=Object.assign({},t.style),l=Object.assign({},n.style);return t.style.height="100%",t.style.overflow="hidden",n.style.top=`-${o}px`,n.style.width="100%",n.style.height="auto",n.style.position="fixed",n.style.overflow=(null==e?void 0:e.overflowType)||"hidden",()=>{t.style.height=i.height||"",t.style.overflow=i.overflow||"",["top","width","height","overflow","position"].forEach((e=>{n.style[e]=l[e]||""})),"scrollBehavior"in document.documentElement.style?window.scrollTo({top:o,behavior:"instant"}):window.scrollTo(0,o)}}(s):function(){const e=document.documentElement,t=Object.assign({},e.style),n=window.innerWidth-e.clientWidth,o=parseInt(window.getComputedStyle(e).paddingRight,10);return e.style.overflow="hidden",e.style.boxSizing="border-box",e.style.paddingRight=`${n+o}px`,()=>{["overflow","boxSizing","paddingRight"].forEach((n=>{e.style[n]=t[n]||""}))}}()),r.lockedNum+=1}function d(t,n){if(e())return;const o=c(n);o.lockedNum-=1,o.lockedNum>0||u(o)||(i(t).forEach((e=>{const t=o.lockedElements.indexOf(e);-1!==t&&(e.ontouchmove=null,e.ontouchstart=null,o.lockedElements.splice(t,1))})),a(o))}function r(t){if(e())return;const n=c(t);if(n.lockedNum=0,!u(n)){if(n.lockedElements.length){let e=n.lockedElements.pop();for(;e;)e.ontouchmove=null,e.ontouchstart=null,e=n.lockedElements.pop()}a(n)}}function u(e){return!t().ios&&("function"==typeof e.unLockCallback&&(e.unLockCallback(),!0))}function a(e){e.documentListenerAdded&&(document.removeEventListener("touchmove",o(),n({passive:!1})),e.documentListenerAdded=!1)}c.lockState=l;export{r as clearBodyLocks,c as getLockState,s as lock,d as unlock};
